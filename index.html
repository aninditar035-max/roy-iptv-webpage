<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Roy Satellite Cable IPTV</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0d1117;
            background-image: radial-gradient(at 0% 0%, #1a202c 0, transparent 50%), radial-gradient(at 100% 100%, #1a202c 0, transparent 50%);
        }
        .card-container {
            perspective: 1000px;
        }
        .card {
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
        }
        .card:hover {
            transform: translateY(-8px) scale(1.02) rotateX(2deg);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.4);
        }
        .button-gradient {
            background-image: linear-gradient(to right, var(--tw-gradient-stops));
            transition: transform 0.2s ease-in-out;
        }
        .button-gradient:hover {
            transform: scale(1.05);
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .animate-pulse-slow {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
    </style>
</head>
<body class="text-white min-h-screen flex flex-col items-center p-4">
    <!-- Navigation -->
    <div class="absolute top-0 left-0 p-4 z-20">
        <div class="relative">
            <input type="checkbox" id="menu-toggle" class="peer hidden">
            <label for="menu-toggle" id="menu-toggle-label" class="cursor-pointer">
                <svg class="w-8 h-8 text-slate-400 hover:text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
            </label>
            <div id="menu" class="hidden peer-checked:block absolute left-0 mt-2 w-48 bg-slate-800 rounded-lg shadow-lg py-2 border border-slate-700">
                <button id="customerLoginBtn" class="w-full text-left block px-4 py-2 text-sm text-slate-300 hover:bg-slate-700 hover:text-white">Customer Login</button>
                <a href="http://admin.nexavision.co.in/" target="_blank" rel="noopener noreferrer" class="block px-4 py-2 text-sm text-slate-300 hover:bg-slate-700 hover:text-white">Admin Login</a>
                <a href="http://operator.nexavision.co.in/" target="_blank" rel="noopener noreferrer" class="block px-4 py-2 text-sm text-slate-300 hover:bg-slate-700 hover:text-white">Operator Login</a>
                <button id="aboutUsBtn" class="w-full text-left block px-4 py-2 text-sm text-slate-300 hover:bg-slate-700 hover:text-white">About Us</button>
            </div>
        </div>
    </div>
    <!-- Main Container -->
    <div class="w-full max-w-4xl mx-auto py-10 px-6 sm:px-8">
        <!-- Title Section -->
        <header class="text-center mb-12">
            <div class="flex items-center justify-center mb-4">
                <span class="text-3xl font-bold tracking-tight text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-sky-500">Roy Satellite Cable</span>
            </div>
            <h1 class="text-5xl sm:text-6xl md:text-7xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-teal-400 via-purple-500 to-indigo-600 mb-4 tracking-tighter">
                Download IPTV
            </h1>
            <p class="text-xl text-slate-400 font-light max-w-xl mx-auto">
                Get the best streaming experience on your favorite devices.
            </p>
        </header>
        <!-- Download Options Grid -->
        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-8 mb-12">
            <!-- Android Download Card -->
            <div class="card-container">
                <div class="card bg-slate-800 p-8 rounded-2xl shadow-xl flex flex-col items-center border border-slate-700">
                    <div class="text-6xl mb-4">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-16 h-16 text-emerald-400">
                            <path d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zm2.5 14h-5c-.829 0-1.5-.671-1.5-1.5V11c0-.829.671-1.5 1.5-1.5h5c.829 0 1.5.671 1.5 1.5v3.5c0 .829-.671 1.5-1.5 1.5zM12 12a.5.5 0 1 1 0-1 .5.5 0 0 1 0 1zm4-3.5a.5.5 0 1 1 0-1 .5.5 0 0 1 0 1z"/>
                            <path d="M12 2c-5.523 0-10 4.477-10 10s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zm2.5 14h-5c-.829 0-1.5-.671-1.5-1.5V11c0-.829.671-1.5 1.5-1.5h5c.829 0 1.5.671 1.5 1.5v3.5c0 .829-.671 1.5-1.5 1.5zM12 12a.5.5 0 1 1 0-1 .5.5 0 0 1 0 1zm4-3.5a.5.5 0 1 1 0-1 .5.5 0 0 1 0 1z"/>
                        </svg>
                    </div>
                    <h2 class="text-2xl font-bold mb-2">Android</h2>
                    <p class="text-sm text-slate-400 mb-6 text-center">APK for all Android smartphones and tablets.</p>
                    <a href="https://raw.githubusercontent.com/aninditar035-max/roy-iptv-webpage/refs/heads/main/Roy%20Satellite%20Cable.apk"
                       class="w-full py-3 px-4 rounded-full font-bold text-center text-white button-gradient from-emerald-500 to-teal-500">
                        Download
                    </a>
                </div>
            </div>
            <!-- TV Download Card -->
            <div class="card-container">
                <div class="card bg-slate-800 p-8 rounded-2xl shadow-xl flex flex-col items-center border border-slate-700">
                    <div class="text-6xl mb-4">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-16 h-16 text-indigo-400">
                            <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
                        </svg>
                    </div>
                    <h2 class="text-2xl font-bold mb-2">TV</h2>
                    <p class="text-sm text-slate-400 mb-6 text-center">Compatible with Android TV boxes and smart TVs.</p>
                    <a href="https://raw.githubusercontent.com/aninditar035-max/roy-iptv-webpage/refs/heads/main/Nexavision%20TV%201.0.6.apk"
                       class="w-full py-3 px-4 rounded-full font-bold text-center text-white button-gradient from-indigo-500 to-blue-500">
                        Download
                    </a>
                </div>
            </div>
            <!-- iOS (Coming Soon) Card -->
            <div class="card-container">
                <div class="card bg-slate-800 p-8 rounded-2xl shadow-xl flex flex-col items-center border border-slate-700 opacity-50 cursor-not-allowed">
                    <div class="text-6xl mb-4">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-16 h-16 text-gray-400">
                            <path d="M18.995 11.232c.112-1.28.665-2.28 1.405-3.08-1.294-1.63-3.116-1.74-3.856-1.77-1.428-1.52-3.185-1.48-4.225-1.47-1.04-.01-2.26.24-3.52 1.3-1.09 1.09-1.95 2.68-1.95 4.39 0 1.28.32 2.51.84 3.73.58 1.34 1.3 2.64 2.22 3.82.91 1.15 1.95 2.37 3.32 2.37.98 0 1.7-.58 2.8-.58 1.12 0 1.7.58 2.8.58 1.37 0 2.41-1.22 3.32-2.37.92-1.18 1.64-2.48 2.22-3.82.52-1.22.84-2.45.84-3.73 0-1.71-.86-3.3-1.95-4.39-1.26-1.06-2.48-1.31-3.52-1.32zm-3.52-1.232c-.01-1.06-.51-2.07-1.31-2.91-.49-.5-1.1-.92-1.79-1.28.49-.02 1.01-.06 1.54-.05 1.05.02 2.05.18 2.9.8.7.6 1.1 1.4 1.25 2.2z"/>
                        </svg>
                    </div>
                    <h2 class="text-2xl font-bold mb-2">iOS</h2>
                    <p class="text-sm text-slate-400 mb-6 text-center">The iOS version is currently in development.</p>
                    <button disabled
                            class="w-full py-3 px-4 rounded-full font-bold text-center text-white bg-slate-700 cursor-not-allowed">
                        Coming Soon
                    </button>
                </div>
            </div>
        </div>
        <!-- Gemini API Feature Section -->
        <div class="bg-slate-800 p-8 rounded-2xl shadow-xl border border-slate-700 text-center">
            <h2 class="text-2xl font-bold mb-4 text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 to-orange-500">
                What is IPTV?
            </h2>
            <p class="text-slate-400 mb-6 max-w-lg mx-auto">
                Discover the power of our app with a description generated by AI.
            </p>
            <button id="generateTextBtn" class="py-3 px-8 rounded-full font-bold text-white button-gradient from-purple-600 to-fuchsia-600">
                Generate Description âœ¨
            </button>
            <div id="loadingIndicator" class="mt-6 hidden flex items-center justify-center space-x-2">
                <div class="h-2 w-2 rounded-full bg-purple-500 animate-pulse-slow delay-0"></div>
                <div class="h-2 w-2 rounded-full bg-purple-500 animate-pulse-slow delay-100"></div>
                <div class="h-2 w-2 rounded-full bg-purple-500 animate-pulse-slow delay-200"></div>
            </div>
            <div id="generatedContent" class="mt-6 text-left text-slate-300 italic text-lg leading-relaxed">
                <p class="text-sm text-slate-500">Click the button above to learn more about IPTV and why our app is the best choice for you.</p>
            </div>
        </div>
    </div>
    
    <!-- Footer Section -->
    <footer class="mt-4 mb-4 text-center text-sm text-slate-500">
        &copy; Created by Parag Roy
    </footer>
    <!-- About Us Modal -->
    <div id="aboutUsModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center p-4 hidden z-50">
        <div class="bg-slate-800 rounded-2xl shadow-xl border border-slate-700 max-w-md w-full p-8 relative text-left">
            <button id="closeModalBtn" class="absolute top-3 right-3 text-slate-400 hover:text-white">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>
            <h2 class="text-2xl font-bold mb-4 text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-sky-500">About Us</h2>
            <div class="text-slate-300 space-y-3">
                <p><strong>Roy Satellite Cable</strong></p>
                <p><strong>Proprietor:</strong> Kumaresh Chandra Roy</p>
                <p><strong>Address:</strong> Nimtala Bazar, Nadia, Chakdah Road, Nimtala Bazar-741257</p>
                <p><strong>Ph No-</strong> 8670612876</p>
            </div>
        </div>
    </div>
    <!-- Customer Login Modal -->
    <div id="customerLoginModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center p-4 hidden z-50">
        <div class="bg-slate-800 rounded-2xl shadow-xl border border-slate-700 max-w-md w-full p-8 relative text-left">
            <button id="closeLoginModalBtn" class="absolute top-3 right-3 text-slate-400 hover:text-white">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>
            <h2 class="text-2xl font-bold mb-4 text-transparent bg-clip-text bg-gradient-to-r from-sky-400 to-cyan-500">Customer Login</h2>
            <p class="text-slate-400 mb-6">Please enter your registered mobile number to continue.</p>
            <div class="space-y-4">
                <input type="tel" id="mobileNumber" placeholder="Enter your mobile number" class="w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-sky-500">
                <button id="continueBtn" class="w-full py-3 px-4 rounded-full font-bold text-center text-white button-gradient from-sky-500 to-cyan-500">
                    Continue
                </button>
                <p id="loginErrorMessage" class="text-red-400 text-sm hidden mt-2 text-center"></p>
            </div>
        </div>
    </div>
    <!-- Customer Details Modal -->
    <div id="customerDetailsModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center p-4 hidden z-50">
        <div class="bg-slate-800 rounded-2xl shadow-xl border border-slate-700 max-w-md w-full p-8 relative text-left">
            <button id="closeDetailsModalBtn" class="absolute top-3 right-3 text-slate-400 hover:text-white">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>
            <h2 class="text-2xl font-bold mb-4 text-transparent bg-clip-text bg-gradient-to-r from-teal-400 to-emerald-500">Customer Details</h2>
            <div id="customerDetailsContent" class="text-slate-300 space-y-3">
                <!-- Customer data will be injected here -->
            </div>
        </div>
    </div>
    <!-- Renewal Modal -->
    <div id="renewalModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center p-4 hidden z-50">
        <div class="bg-slate-800 rounded-2xl shadow-xl border border-slate-700 max-w-md w-full p-8 relative text-left">
            <button id="closeRenewalModalBtn" class="absolute top-3 right-3 text-slate-400 hover:text-white">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>
            <h2 class="text-2xl font-bold mb-4 text-transparent bg-clip-text bg-gradient-to-r from-orange-400 to-red-500">Renew Your Pack</h2>
            <div id="renewalContent" class="text-slate-300 space-y-3">
                <!-- Customer info and packs will be injected here -->
            </div>
            <button id="payNowBtn" class="w-full py-3 px-4 rounded-full font-bold text-center text-white button-gradient from-orange-500 to-red-500 mt-6">
                Pay Now
            </button>
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- IMPORTANT: Paste your Google Sheet URL here ---
            const GOOGLE_SHEET_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR02XzKiEQKAWf9sEHzbqtD6S-AtaRiCi7dusgomsiJYc_aRPpNy0Gulq2Gix9M6AqH9RIg0XkHrm2S/pub?output=csv';
            const generateTextBtn = document.getElementById('generateTextBtn');
            const generatedContent = document.getElementById('generatedContent');
            const loadingIndicator = document.getElementById('loadingIndicator');
            const menuToggle = document.getElementById('menu-toggle');
            
            // About Us Modal elements
            const aboutUsBtn = document.getElementById('aboutUsBtn');
            const aboutUsModal = document.getElementById('aboutUsModal');
            const closeModalBtn = document.getElementById('closeModalBtn');
            
            // Customer Login Modal elements
            const customerLoginBtn = document.getElementById('customerLoginBtn');
            const customerLoginModal = document.getElementById('customerLoginModal');
            const closeLoginModalBtn = document.getElementById('closeLoginModalBtn');
            const continueBtn = document.getElementById('continueBtn');
            const mobileNumberInput = document.getElementById('mobileNumber');
            const loginErrorMessage = document.getElementById('loginErrorMessage');
            // Customer Details Modal elements
            const customerDetailsModal = document.getElementById('customerDetailsModal');
            const closeDetailsModalBtn = document.getElementById('closeDetailsModalBtn');
            const customerDetailsContent = document.getElementById('customerDetailsContent');
            // Renewal Modal elements
            const renewalModal = document.getElementById('renewalModal');
            const closeRenewalModalBtn = document.getElementById('closeRenewalModalBtn');
            const renewalContent = document.getElementById('renewalContent');
            const payNowBtn = document.getElementById('payNowBtn');
            
            let currentUser = null; // To store current user data for renewal
            
            // --- Gemini API Call ---
            generateTextBtn.addEventListener('click', () => {
                loadingIndicator.classList.remove('hidden');
                generatedContent.classList.add('hidden');
                const prewrittenText = `IPTV stands for Internet Protocol television (Internet Protocol TV), which is a method of delivering television content and other video services to subscribers using the internet. Unlike traditional cable or satellite TV, IPTV relies on an internet connection to send video signals to a TV or device, offering interactive features, on-demand viewing, and high-quality streaming.`;
                setTimeout(() => {
                    loadingIndicator.classList.add('hidden');
                    generatedContent.classList.remove('hidden');
                    generatedContent.innerHTML = `<p>${prewrittenText}</p>`;
                }, 500);
            });
            // --- Menu and Modal Logic ---
            aboutUsBtn.addEventListener('click', () => {
                aboutUsModal.classList.remove('hidden');
                menuToggle.checked = false;
            });
            closeModalBtn.addEventListener('click', () => aboutUsModal.classList.add('hidden'));
            aboutUsModal.addEventListener('click', (e) => {
                if (e.target === aboutUsModal) aboutUsModal.classList.add('hidden');
            });
            customerLoginBtn.addEventListener('click', () => {
                loginErrorMessage.classList.add('hidden');
                mobileNumberInput.value = '';
                customerLoginModal.classList.remove('hidden');
                menuToggle.checked = false;
            });
            closeLoginModalBtn.addEventListener('click', () => customerLoginModal.classList.add('hidden'));
            customerLoginModal.addEventListener('click', (e) => {
                if (e.target === customerLoginModal) customerLoginModal.classList.add('hidden');
            });
            closeDetailsModalBtn.addEventListener('click', () => customerDetailsModal.classList.add('hidden'));
            customerDetailsModal.addEventListener('click', (e) => {
                if (e.target === customerDetailsModal) customerDetailsModal.classList.add('hidden');
            });
            closeRenewalModalBtn.addEventListener('click', () => renewalModal.classList.add('hidden'));
            renewalModal.addEventListener('click', (e) => {
                if (e.target === renewalModal) renewalModal.classList.add('hidden');
            });
            // Pay Now button placeholder (redirect to payment gateway later)
            payNowBtn.addEventListener('click', () => {
                // Replace with actual payment gateway URL
                window.location.href = 'https://example.com/payment-gateway'; // Placeholder
            });
            // --- Main Logic: Fetch and Search Customer Data ---
            const searchForCustomer = async () => {
                const mobileNumber = mobileNumberInput.value.trim();
                if (!mobileNumber) {
                    loginErrorMessage.textContent = 'Please enter a mobile number.';
                    loginErrorMessage.classList.remove('hidden');
                    return;
                }
                if (GOOGLE_SHEET_URL === 'YOUR_GOOGLE_SHEET_CSV_URL_HERE') {
                    loginErrorMessage.textContent = 'Error: Google Sheet URL is not configured.';
                    loginErrorMessage.classList.remove('hidden');
                    return;
                }
                continueBtn.disabled = true;
                continueBtn.textContent = 'Searching...';
                loginErrorMessage.classList.add('hidden');
                try {
                    // Add cache-busting parameter to force fresh data
                    const cacheBust = new Date().getTime();
                    const urlWithCacheBust = `${GOOGLE_SHEET_URL}&_=${cacheBust}`;
                    // Using a more reliable CORS proxy to prevent cross-origin errors.
                    const response = await fetch(`https://api.allorigins.win/raw?url=${encodeURIComponent(urlWithCacheBust)}`, {
                        cache: 'no-cache' // Prevent browser caching
                    });
                    if (!response.ok) throw new Error('Network response was not ok.');
                    
                    const csvText = await response.text();
                    const customerData = parseCSV(csvText);
                    const user = customerData.find(c => c.mobile === mobileNumber);
                    if (user) {
                        currentUser = user; // Store user for renewal
                        displayCustomerDetails(user);
                    } else {
                        loginErrorMessage.textContent = 'Mobile number not found. Please try again.';
                        loginErrorMessage.classList.remove('hidden');
                    }
                } catch (error) {
                    console.error('Failed to fetch or parse customer data:', error);
                    loginErrorMessage.textContent = 'Could not retrieve customer data. Please try again later.';
                    loginErrorMessage.classList.remove('hidden');
                } finally {
                    continueBtn.disabled = false;
                    continueBtn.textContent = 'Continue';
                }
            };
            const displayCustomerDetails = (user) => {
                const currentDate = new Date();
                let expiryDate;
                try {
                    expiryDate = new Date(user.validity || '');
                } catch (e) {
                    expiryDate = null;
                }
                
                // Set hours to 0 to compare dates only, ignoring time
                currentDate.setHours(0, 0, 0, 0);
                if (expiryDate) expiryDate.setHours(0, 0, 0, 0);
                
                const isExpired = expiryDate && expiryDate < currentDate;
                const expiryLabel = isExpired ? 'Expired' : 'Expiry';
                const validityDisplay = user.validity && user.validity.trim() !== '' ? user.validity : 'N/A';
                
                let renewButton = '';
                if (isExpired) {
                    renewButton = `<button id="renewNowBtn" class="w-full py-3 px-4 rounded-full font-bold text-center text-white button-gradient from-orange-500 to-red-500 mt-4">Renew Now</button>`;
                }
                
                customerDetailsContent.innerHTML = `
                    <p><strong>Name:</strong> ${user.name || 'N/A'}</p>
                    <p><strong>Plan:</strong> ${user.plan || 'N/A'}</p>
                    <p><strong>${expiryLabel}:</strong> <span class="text-red-500">${validityDisplay}</span></p>
                    ${renewButton}
                `;
                customerLoginModal.classList.add('hidden');
                customerDetailsModal.classList.remove('hidden');
                
                // Add event listener for Renew Now if present
                if (isExpired) {
                    document.getElementById('renewNowBtn').addEventListener('click', () => {
                        displayRenewalOptions(user);
                    });
                }
            };
            const displayRenewalOptions = (user) => {
                // Single pack as specified
                const packs = [
                    { name: 'All Channel Pack', description: 'Access to all channels', price: 'â‚¹100' }
                ];
                
                // Since there's only one, it's auto-selected
                let packsHTML = '<h3 class="text-xl font-bold mb-2">Packs Available</h3>';
                packs.forEach((pack) => {
                    packsHTML += `
                        <div class="bg-slate-700 p-4 rounded-lg mb-4 border-2 border-orange-500">
                            <p class="text-center"><strong>${pack.name}</strong></p>
                            <p class="text-center">${pack.description}</p>
                            <p class="font-bold text-center text-2xl">${pack.price}</p>
                        </div>
                    `;
                });
                
                renewalContent.innerHTML = `
                    <h3 class="text-xl font-bold mb-2">Customer Information</h3>
                    <p><strong>Name:</strong> ${user.name || 'N/A'}</p>
                    <p><strong>Mobile:</strong> ${user.mobile || 'N/A'}</p>
                    <p><strong>Current Plan:</strong> ${user.plan || 'N/A'}</p>
                    ${packsHTML}
                `;
                customerDetailsModal.classList.add('hidden');
                renewalModal.classList.remove('hidden');
            };
            const parseCSV = (text) => {
                const lines = text.trim().split(/\r?\n/); // Handle different line endings
                if (lines.length === 0) return [];
                
                const headers = lines[0].split(',').map(h => h.trim().toLowerCase());
                const data = lines.slice(1).map(line => {
                    const values = line.split(',').map(v => v.trim());
                    let entry = {};
                    headers.forEach((header, index) => {
                        if (index < values.length) {
                            entry[header] = values[index];
                        } else {
                            entry[header] = ''; // Handle missing values
                        }
                    });
                    // Map possible variations of keys
                    entry.mobile = entry.mobile || entry['mobile number'] || entry.phone || '';
                    entry.name = entry.name || entry['customer name'] || '';
                    entry.plan = entry.plan || entry['subscription plan'] || '';
                    entry.validity = entry.validity || entry['validity date'] || entry.expiry || entry['expiration date'] || entry['expiry date'] || '';
                    return entry;
                });
                return data;
            };
            continueBtn.addEventListener('click', searchForCustomer);
            mobileNumberInput.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    searchForCustomer();
                }
            });
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    if (!aboutUsModal.classList.contains('hidden')) aboutUsModal.classList.add('hidden');
                    else if (!customerLoginModal.classList.contains('hidden')) customerLoginModal.classList.add('hidden');
                    else if (!customerDetailsModal.classList.contains('hidden')) customerDetailsModal.classList.add('hidden');
                    else if (!renewalModal.classList.contains('hidden')) renewalModal.classList.add('hidden');
                    else if (menuToggle.checked) menuToggle.checked = false;
                }
            });
        });
    </script>
</body>
</html>
